<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:k="http://xmlns.jcp.org/jsf/composite/components"
                xmlns:faces="http://xmlns.jcp.org/jsf"
                xmlns:f="http://xmlns.jcp.org/jsf/core">

    <div class="grid formgrid ui-fluid">
        <ui:fragment rendered="#{entiteBean.entityId == null and entiteBean.idEntite == null}">
            <div class="field col-12 md:col-4 lg:col-3">
                <p:outputLabel for="entityParent" value="#{msge['core.pages.entity.fields.parent.label']}"/>
                <k:entitySelectOneMenu id="entityParent" required="false"
                                       requiredMessage="#{msg['core.pages.entity-variable.field.entity.requiredMessage']}"
                                       value="#{entiteBean.entity.parent}">
                    <p:ajax event="change" listener="#{entiteBean.loadChildren()}" update="@(.beRoot) @(.entityType)"/>
                </k:entitySelectOneMenu>
            </div>
        </ui:fragment>

        <div class="field col-12 md:col-4 lg:col-3" faces:rendered="#{entiteBean.entity.parent != null and (entiteBean.entityId != null or entiteBean.idEntite != null)}">
            <p:outputLabel for="entityParentText" value="#{msge['core.pages.entity.fields.parent.label']}"/>
            <p:inputText id="entityParentText" value="#{entiteBean.entity.parent.label}" disabled="true"/>
        </div>

        <ui:fragment rendered="#{not entiteBean.entity.root and (entiteBean.entityId == null)}">
            <div class="field col-12 md:col-4 lg:col-3">
                <p:outputLabel for="enttype" value="#{msge['core.pages.entity.fields.entity-type.label']}"/>
                <p:selectOneMenu id="enttype" styleClass="entityType" required="true"
                                 requiredMessage="#{msge['core.pages.entity.fields.entity-type.label.requiredMessage']}"
                                 value="#{entiteBean.entity.entityType}" converter="omnifaces.SelectItemsConverter">
                    <f:selectItem noSelectionOption="true" itemLabel="-- #{msg['core.page.fields.select.message']} --"/>
                    <f:selectItems value="#{entiteBean.typeEntites}" var="te" itemValue="#{te}" itemLabel="#{te.label}"/>
                    <p:ajax listener="#{entiteBean.canBeRoot()}" update="can-be-root"/>
                </p:selectOneMenu>
            </div>
        </ui:fragment>

        <div class="field col-12 md:col-4 lg:col-3">
            <h:inputHidden id="entity-id" value="#{entiteBean.entity.id}"/>
            <p:outputLabel for="nom-legal" value="#{msge['core.pages.entity.fields.legalName']}"/>
            <p:inputText id="nom-legal" required="true"
                         requiredMessage="#{msge['core.pages.entity.fields.legalName.requiredMessage']}"
                         label="#{msge['core.pages.entity.fields.legalName']}"
                         value="#{entiteBean.entity.label}"/>
        </div>
        <div class="field col-12 md:col-4 lg:col-3">
            <p:outputLabel for="denomination" value="#{msge['core.pages.entity.fields.denomination']}"/>
            <p:inputText id="denomination" required="true"
                         requiredMessage="#{msge['core.pages.entity.fields.denomination.requiredMessage']}"
                         label="#{msge['core.pages.entity.fields.denomination']}"
                         value="#{entiteBean.entity.denomination}"/>
        </div>
        <div class="field col-12 md:col-4 lg:col-3">
            <h:outputLabel for="approval-number" value="#{msge['core.pages.entity.fields.approvalNumber']}"/>
            <p:inputText id="approval-number" value="#{entiteBean.entity.numeroApprouve}"
                         label="#{msg['core.pages.entity.fields.approvalNumber']}"
                         required="false"/>
        </div>
        <div class="field col-12 md:col-4 lg:col-3">
            <h:outputLabel for="description" value="#{msge['core.pages.entity.fields.description']}"/>
            <p:inputTextarea id="description" value="#{entiteBean.entity.description}"
                             label="#{msg['core.pages.entity.fields.description']}">
            </p:inputTextarea>
        </div>
        <ui:fragment rendered="#{entiteBean.canCreateRootEntity() and entiteBean.idEntite == null}">
            <div class="field col lg:col-3 md:col-3">
                <p:outputLabel value="#{msge['core.pages.entity.fields.racine']}"/>
                <div class="field-checkbox">
                    <p:toggleSwitch id="can-be-root" styleClass="beRoot" disabled="#{not entiteBean.root or entiteBean.entity.parent != null}" value="#{entiteBean.entity.root}" onIcon="pi pi-check" offIcon="pi pi-times">
                    </p:toggleSwitch>
                </div>
            </div>
        </ui:fragment>
    </div>
</ui:composition>